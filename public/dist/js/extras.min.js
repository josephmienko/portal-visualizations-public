!function t(e,a,r){function n(o,l){if(!a[o]){if(!e[o]){var s="function"==typeof require&&require;if(!l&&s)return s(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var f=a[o]={exports:{}};e[o][0].call(f.exports,function(t){var a=e[o][1][t];return n(a?a:t)},f,f.exports,t,e,a,r)}return a[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(t,e,a){var r=t("./DetectFeatureSupport.js");e.exports={init:function(){var t=this,e=r.detectIE(),a=$("#data-title h2").text().replace(/ /g,"_");t.appendCitation(),$("#js-citationDownload").on("click",function(){var r=t.scrapeCitationDetails(),n=new Blob([r]);e?window.navigator.msSaveOrOpenBlob(n,a+".txt"):saveAs(n,a+".txt")})},appendCitation:function(){var t,e,a,r;t=$("#data-title h2").text();var n=new Date;e=n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear(),a=n.getFullYear(),longUrl=window.location.href,r=longUrl.replace("!","").replace("#",""),$("#citation-title").empty().append(t),$("#citation-year").empty().append(a),$("#citation-date").empty().append(e),$("#citation-url").empty().append(r)},scrapeCitationDetails:function(){var t,e,a,r;return t=$("#data-title h2").text(),citation=$("#citation-example").text(),e=$("#dbUpdated").text(),a="Filters used: \r\n",$(".config-type-filter.visible").each(function(){var t=$(this).children().find(".fieldsetLabel").text(),e=$(this).children().find(".fieldInput:checked").next("label").map(function(){return $(this).text()}).get().join("; ");"Date Range"==t&&(e=$("#dynamicMonthStart .slider").text()),a+="\t"+t+": "+e+"\r\n"}),$("#citation-filters .filter").each(function(){var t=$(this).text();a+="\t"+t+"\r\n"}),r="Citation downloaded from Center for Social Sector Analytics & Technology\r\n\r\n",r+=citation+"\r\n\r\n",r+=a+"\r\n\r\n",r+=e+"\r\n\r\n"}}},{"./DetectFeatureSupport.js":3}],2:[function(t,e,a){var r=t("./DetectFeatureSupport.js"),n=function(t){var e='"'+t.replace(/"/g,'""')+'"';return e};e.exports={downloadFile:$("#data-title h2").text().replace(/ /g,"_"),init:function(){var t=this,e=r.detectIE();$("#js-dataDownload").on("click",function(){e?t.toText():t.toCSV()})},toCSV:function(){var t=",",e=this.scrapeTableData(t),a=new Blob([e],{type:"text/plain;charset=utf-8"});saveAs(a,this.downloadFile+".csv")},toText:function(){var t="\t",e=this.scrapeTableData(t),a=new Blob([e]);window.navigator.msSaveOrOpenBlob(a,this.downloadFile+".txt")},scrapeTableData:function(t){for(var e=$("table.google-visualization-table-table")[0],a=e.rows.length,r=e.rows[0].cells.length,i="",o=0;o<r;o++){var l=e.rows[0].cells[o],s=n(l.textContent.split(String.fromCharCode(8195)).join(""));0!==o&&(i+=t),i+=s}i+="\r\n";for(var c=1;c<a;c++){for(var f=0;f<r;f++){var d=e.rows[c].cells[f],u=d.innerHTML.split(",").join("");0!==f&&(i+=t),i+=u}i+="\r\n"}return i}}},{"./DetectFeatureSupport.js":3}],3:[function(t,e,a){e.exports={detectIE:function(){var t=-1;if("Microsoft Internet Explorer"==navigator.appName){var e=navigator.userAgent,a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=a.exec(e)&&(t=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){var e=navigator.userAgent,a=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");null!=a.exec(e)&&(t=parseFloat(RegExp.$1))}return t!=-1},detectSVG:function(){var t="undefined"!=typeof SVGRect;return t}}},{}],4:[function(t,e,a){var r=t("./DataDownload.js"),n=t("./CitationDownload.js"),i=t("./Share.js"),o=t("./ImageDownload.js"),l={run:function(){r.init(),n.init(),i.init(),o.init()}};l.run()},{"./CitationDownload.js":1,"./DataDownload.js":2,"./ImageDownload.js":5,"./Share.js":6}],5:[function(t,e,a){var r=t("./DetectFeatureSupport.js");e.exports={init:function(){var t=this;t.bindUIEvents()},bindUIEvents:function(){var t=this,e=r.detectSVG(),a=!1;try{a=!!new Blob}catch(n){}"undefined"!=typeof requestFileSystem||"undefined"!=typeof webkitRequestFileSystem||"undefined"!=typeof mozRequestFileSystem||"undefined"!=typeof navigator.msSaveBlob;e&&a?($("#js-imageDownload").click(function(){t.graphToDataURL(),t.downloadImage()}),$("#update").click(function(){setTimeout(function(){t.graphToDataURL()},5e3)})):alert("Sorry, this feature is not supported for your broswer")},downloadImage:function(){var t=$("#canvas canvas"),e=$("#data-title h2").text().replace(/ /g,"_"),a=e+".png",r=$(t)[0];r.toBlob(function(t){saveAs(t,a)})},graphToDataURL:function(){var t=0,e=0,a=$("#canvas canvas"),r=a[0],n=r.getContext("2d"),i=60,o=$("#data-title").css("font-family"),l="bold 16px "+o;t+=2*i,offset=[],$("#chart svg").each(function(a){offset[a]=t;var r=parseInt($(this).attr("height")),n=parseInt($(this).attr("width"));console.log("Height: "+r+" width: "+n),t+=r,e=n>e?n:e}),n.save();for(var s=$("#chartLegend td").css("font-family"),c=$("#chartLegend table tr"),f=10,d=5,u=5,p=[],v=[],h=[],g=[],x=[],m=0;m<c.length;m++){var w=0===m?"bold":"normal";g[m]=w+" "+f+"px "+s,n.font=g[m];var D=c[m];x[m]=[],p[m+1]=t,t+=f+d;var y=$(D),b=y.children("td");b.length||(b=y.children("th"));for(var S=0;S<b.length;S++){var F=b[S],R=$(F).text();R=R?R:"",R=R.replace("&nbsp;"," "),x[m][S]=R;var C=n.measureText(R).width;v[S]=0===m||!v[S]||C>v[S]?C:v[S],0===S&&(h[m]=$(F).css("background-color"))}}var j=[],T=0;v[0]=f;for(var k=0;k<v.length;k++){j[k]=T;var L=v[k];T+=L+u}e=T>e?T:e,t+=50,n.restore();var U=$("#dbUpdated").text(),A=new Date,E=A.getMonth()+1+"/"+A.getDate()+"/"+A.getFullYear();a.height(t),a.width(e),r.height=t,r.width=e,n.save(),n.fillStyle="#ffffff",n.fillRect(0,0,e,t),n.restore(),n.save(),n.fillStyle="#000000",n.font=l,n.textAlign="center";var I=$("#data-title h2").text();n.fillText(I,r.width/2,i),n.restore(),n.save(),n.fillStyle="#000000",n.font="normal 14px"+o,n.textAlign="center";var O=$("#data-title h4").text();n.fillText(O,r.width/2,i+20),n.restore();var B=$("#chart svg").siblings("div");$(B).remove(),$("#chart svg").each(function(t,e){var a=e.parentNode.innerHTML,i={offsetY:offset[t],ignoreClear:!0,ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0};n.save(),canvg(r,a,i),n.restore()}),n.save();for(var m=0;m<h.length;m++){var M=h[m];M&&(n.fillStyle=M,n.fillRect(15,p[m],f,f))}n.restore(),n.save(),n.textAlign="left";for(var m=0;m<x.length;m++){n.font=g[m];for(var S=0;S<x[m].length;S++){var R=x[m][S];if(R){var P=p[m]+f,q=j[S];n.fillText(R,q+15,P)}}}n.restore(),n.save();var N=t-5;dateText=U+"  |  Data accessed "+E,n.textAlign="left",n.fillText(dateText,25,N),n.restore(),n.save();var V="http://data.partnersforourchildren.org/",_=N;if(n.textAlign="right",n.fillText(V,e-200,_),n.restore(),r.toDataURL){var z=$("#image img")[0];z.src=r.toDataURL()}}}},{"./DetectFeatureSupport.js":3}],6:[function(t,e,a){e.exports={init:function(){var t=this;$("#js-share").click(function(){var e=t.makeLongURL();t.makeShortURL(e)});var e=function(){gapi.client.setApiKey("AIzaSyA5Jz5mOEW1k83BwmuD8O4PEKv8v0AaiEU"),gapi.client.load("urlshortener","v1",function(){})};window.onload=e},appendShareLinks:function(t){$("#twitter").attr("href","http://twitter.com/share?url="+t),$("#email").attr("href","mailto:"+t),$("#facebook").attr("href","http://www.facebook.com/sharer.php?u="+t)},makeLongURL:function(){var t=this,e=t.getParamsArray(),a=window.location.href,r=a.indexOf("#");r>0&&(a=a.substring(0,r));var n="#";for(var i in e)for(var o=e[i],l=0;l<o.length;l++){var s=o[l];a+=n+i+"="+s,n="&"}return a},makeShortURL:function(t){var e=this,a=gapi.client.urlshortener.url.insert({resource:{longUrl:t}});a.execute(function(t){var a=t.id;$("#short-url").empty(),$("#short-url").append('<a href="'+a+'">'+a+"</a>"),e.appendShareLinks(a)})},getParamsArray:function(){var t={},e=this;return $(".fieldset.visible").each(function(){var a=$(this),r=a.attr("id"),n=void 0;a.hasClass("config-type-dateRange")||a.hasClass("config-type-dynamicDateRange")?n=e.getParamsFromFieldsetRange(a):a.hasClass("config-type-param")||a.hasClass("config-type-filter")?n=e.getParamsFromFieldsetCheckboxes(a):consoleLog("Unexpected parameter to get: "+fieldName),n&&(t[r]=n)}),t},getParamsFromFieldsetCheckboxes:function(t){var e=[];return t.find("input:checked").each(function(){var t=$(this).val();e.push(t)}),e},getParamsFromFieldsetRange:function(t){var e=t.find(".control").slider("option","values");return e}}},{}]},{},[4]);